# è¯­è¨€åˆ‡æ¢åŠŸèƒ½ä½¿ç”¨æŒ‡å— / Language Switching Guide

## æ¦‚è¿° / Overview

Prvin AIæ—¥å†åº”ç”¨ç°å·²æ”¯æŒä¸­è‹±æ–‡åŒè¯­åˆ‡æ¢åŠŸèƒ½ï¼Œæä¾›æ— ç¼çš„å¤šè¯­è¨€ç”¨æˆ·ä½“éªŒã€‚æ–°å¢çš„ä¸€é”®è¯­è¨€åˆ‡æ¢åŠŸèƒ½è®©è¯­è¨€åˆ‡æ¢å˜å¾—æ›´åŠ å¿«é€Ÿå’Œç›´è§‚ã€‚

The Prvin AI Calendar app now supports bilingual switching between Chinese and English, providing a seamless multilingual user experience. The new one-click language toggle feature makes language switching faster and more intuitive.

## åŠŸèƒ½ç‰¹æ€§ / Features

### âœ… å·²å®ç°åŠŸèƒ½ / Implemented Features

1. **ä¸€é”®è¯­è¨€åˆ‡æ¢** / One-Click Language Toggle
   - ç‚¹å‡»æŒ‰é’®å³å¯åœ¨ä¸­è‹±æ–‡ä¹‹é—´å¿«é€Ÿåˆ‡æ¢
   - Click button to quickly switch between Chinese and English
   - æ— éœ€å¯¹è¯æ¡†ç¡®è®¤ï¼Œå³æ—¶åˆ‡æ¢
   - No dialog confirmation needed, instant switching

2. **è¿è¡Œæ—¶è¯­è¨€åˆ‡æ¢** / Runtime Language Switching
   - æ— éœ€é‡å¯åº”ç”¨å³å¯åˆ‡æ¢è¯­è¨€
   - Switch languages without restarting the app

3. **æŒä¹…åŒ–å­˜å‚¨** / Persistent Storage
   - è¯­è¨€åå¥½è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
   - Language preferences automatically saved to local storage

4. **å®Œæ•´çš„æœ¬åœ°åŒ–æ”¯æŒ** / Complete Localization Support
   - 80+ å­—ç¬¦ä¸²å·²æœ¬åœ°åŒ–
   - 80+ strings localized
   - æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡
   - Supports Chinese and English

5. **æ™ºèƒ½çŠ¶æ€ç®¡ç†** / Intelligent State Management
   - è¯­è¨€åˆ‡æ¢ä¸å½±å“å…¶ä»–åº”ç”¨çŠ¶æ€
   - Language switching doesn't affect other app states
   - å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
   - Complete error handling and recovery mechanisms

6. **ä¼˜é›…çš„UIç»„ä»¶** / Elegant UI Components
   - ä¸€é”®åˆ‡æ¢æŒ‰é’®ï¼ˆæ˜¾ç¤ºå½“å‰è¯­è¨€ï¼‰
   - One-click toggle button (shows current language)
   - ä¼ ç»Ÿè¯­è¨€åˆ‡æ¢å™¨ï¼ˆåœ°çƒå›¾æ ‡ + å¯¹è¯æ¡†ï¼‰
   - Traditional language switcher (globe icon + dialog)
   - å®Œæ•´çš„å¯è®¿é—®æ€§æ”¯æŒ
   - Full accessibility support

## ä½¿ç”¨æ–¹æ³• / Usage

### 1. ä¸€é”®è¯­è¨€åˆ‡æ¢ / One-Click Language Toggle

#### æ¨èæ–¹å¼ï¼šä¸€é”®åˆ‡æ¢æŒ‰é’® / Recommended: One-Click Toggle Button
1. åœ¨æ—¥å†é¡µé¢ï¼Œæ‰¾åˆ°æ˜¾ç¤ºå½“å‰è¯­è¨€çš„æŒ‰é’®ï¼ˆ"ä¸­" æˆ– "EN"ï¼‰
2. ç‚¹å‡»æŒ‰é’®å³å¯ç«‹å³åˆ‡æ¢åˆ°å¦ä¸€ç§è¯­è¨€
3. æŒ‰é’®ä¼šè‡ªåŠ¨æ›´æ–°æ˜¾ç¤ºæ–°çš„è¯­è¨€çŠ¶æ€

1. On the calendar page, find the button showing current language ("ä¸­" or "EN")
2. Click the button to immediately switch to the other language
3. Button automatically updates to show the new language state

**ç‰¹ç‚¹ / Features:**
- âš¡ å³æ—¶åˆ‡æ¢ï¼Œæ— å»¶è¿Ÿ / Instant switching, no delay
- ğŸ¯ ä¸€é”®æ“ä½œï¼Œæ— éœ€ç¡®è®¤ / One-click operation, no confirmation needed
- ğŸ“± ç›´è§‚æ˜¾ç¤ºå½“å‰è¯­è¨€çŠ¶æ€ / Intuitive display of current language state
- â™¿ å®Œæ•´çš„å¯è®¿é—®æ€§æ”¯æŒ / Full accessibility support

#### ä¼ ç»Ÿæ–¹å¼ï¼šè¯­è¨€åˆ‡æ¢å™¨ / Traditional: Language Switcher
1. åœ¨æ—¥å†é¡µé¢ï¼Œç‚¹å‡»å³ä¸Šè§’çš„åœ°çƒå›¾æ ‡ ğŸŒ
2. åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­é€‰æ‹©æ‚¨æƒ³è¦çš„è¯­è¨€ï¼ˆä¸­æ–‡/Englishï¼‰
3. è¯­è¨€å°†ç«‹å³åˆ‡æ¢

1. On the calendar page, tap the globe icon ğŸŒ in the top right
2. Select your desired language (ä¸­æ–‡/English) in the popup dialog
3. Language will switch immediately

### 2. ç¨‹åºåŒ–åˆ‡æ¢ / Programmatic Switching

#### ä½¿ç”¨ä¸€é”®åˆ‡æ¢API / Using One-Click Toggle API
```dart
// åœ¨ä»»ä½•Widgetä¸­ä½¿ç”¨ä¸€é”®åˆ‡æ¢
await context.toggleLanguage();

// æˆ–è€…ä½¿ç”¨æ‰©å±•æ–¹æ³•
await AppLocalizationsToggle.toggleLanguage(context);
```

#### ä½¿ç”¨ä¼ ç»Ÿåˆ‡æ¢API / Using Traditional Switch API
```dart
// åˆ‡æ¢åˆ°æŒ‡å®šè¯­è¨€
context.changeLanguage('en'); // åˆ‡æ¢åˆ°è‹±æ–‡
context.changeLanguage('zh'); // åˆ‡æ¢åˆ°ä¸­æ–‡

// æˆ–è€…ç›´æ¥ä½¿ç”¨AppLocalizations
AppLocalizations.changeLanguage(context, 'en');
```

### 2. è·å–æœ¬åœ°åŒ–æ–‡æœ¬ / Get Localized Text

#### ä½¿ç”¨æ‰©å±•æ–¹æ³• / Using Extension Method
```dart
Text(context.l10n('app_name', fallback: 'é»˜è®¤æ–‡æœ¬'))
```

#### ç›´æ¥ä½¿ç”¨AppLocalizations / Direct AppLocalizations Usage
```dart
Text(AppLocalizations.get('app_name', fallback: 'é»˜è®¤æ–‡æœ¬'))
```

### 3. ä¸€é”®åˆ‡æ¢æŒ‰é’®é›†æˆ / One-Click Toggle Button Integration

#### åŸºæœ¬ä½¿ç”¨ / Basic Usage
```dart
import 'package:prvin/core/widgets/one_click_language_toggle_button.dart';

// åœ¨ä»»ä½•é¡µé¢ä¸­æ·»åŠ ä¸€é”®åˆ‡æ¢æŒ‰é’®
OneClickLanguageToggleButton()

// è‡ªå®šä¹‰å°ºå¯¸å’ŒåŠ¨ç”»
OneClickLanguageToggleButton(
  size: 48.0,
  animationDuration: Duration(milliseconds: 400),
)
```

#### è·å–åˆ‡æ¢ç»Ÿè®¡ä¿¡æ¯ / Get Toggle Statistics
```dart
// è·å–åˆ‡æ¢ç»Ÿè®¡
final stats = OneClickLanguageToggleButton.getToggleStatistics();
print('åˆ‡æ¢æ¬¡æ•°: ${stats.toggleCount}');
print('å½“å‰ä¼šè¯ID: ${stats.sessionId}');

// éªŒè¯å¹‚ç­‰æ€§
final idempotence = OneClickLanguageToggleButton.verifyToggleIdempotence();
print('å¹‚ç­‰æ€§éªŒè¯: ${idempotence.isValid}');

// è·å–æ€§èƒ½æŠ¥å‘Š
final performance = OneClickLanguageToggleButton.getPerformanceReport();
print('å¹³å‡å“åº”æ—¶é—´: ${performance.averageResponseTime}ms');
```

## å¼€å‘è€…æŒ‡å— / Developer Guide

### ä¸€é”®åˆ‡æ¢æŒ‰é’®API / One-Click Toggle Button API

#### æ ¸å¿ƒç»„ä»¶ / Core Components

**OneClickLanguageToggleButton** - ä¸€é”®è¯­è¨€åˆ‡æ¢æŒ‰é’®
```dart
class OneClickLanguageToggleButton extends StatefulWidget {
  const OneClickLanguageToggleButton({
    super.key,
    this.size = 40.0,
    this.animationDuration = const Duration(milliseconds: 300),
  });

  /// æŒ‰é’®å°ºå¯¸ / Button size
  final double size;
  
  /// åŠ¨ç”»æŒç»­æ—¶é—´ / Animation duration
  final Duration animationDuration;
}
```

**LanguageToggleState** - è¯­è¨€çŠ¶æ€æšä¸¾
```dart
enum LanguageToggleState {
  chinese('zh', 'ä¸­'),
  english('en', 'EN');
  
  /// è·å–ä¸‹ä¸€ä¸ªè¯­è¨€çŠ¶æ€ / Get next language state
  LanguageToggleState get next;
  
  /// ä»è¯­è¨€ä»£ç åˆ›å»ºçŠ¶æ€ / Create state from language code
  static LanguageToggleState fromCode(String code);
}
```

**ToggleButtonState** - æŒ‰é’®çŠ¶æ€æ•°æ®æ¨¡å‹
```dart
class ToggleButtonState {
  const ToggleButtonState({
    required this.currentLanguage,
    required this.isAnimating,
    required this.displayText,
  });

  /// å½“å‰è¯­è¨€ä»£ç  / Current language code
  final String currentLanguage;
  
  /// æ˜¯å¦æ­£åœ¨æ‰§è¡ŒåŠ¨ç”» / Whether animating
  final bool isAnimating;
  
  /// æ˜¾ç¤ºæ–‡æœ¬ / Display text
  final String displayText;
}
```

#### æ‰©å±•æ–¹æ³• / Extension Methods

**AppLocalizationsToggle** - AppLocalizationsæ‰©å±•
```dart
extension AppLocalizationsToggle on AppLocalizations {
  /// ä¸€é”®åˆ‡æ¢è¯­è¨€ / One-click language toggle
  static Future<void> toggleLanguage(BuildContext context);
  
  /// å¸¦é”™è¯¯å¤„ç†çš„è¯­è¨€åˆ‡æ¢ / Language change with error handling
  static Future<void> changeLanguageWithErrorHandling(
    BuildContext context,
    String locale,
  );
}
```

**LocalizationExtensionToggle** - BuildContextæ‰©å±•
```dart
extension LocalizationExtensionToggle on BuildContext {
  /// ä¸€é”®åˆ‡æ¢è¯­è¨€ / One-click language toggle
  Future<void> toggleLanguage();
  
  /// è·å–ä¸‹ä¸€ä¸ªè¯­è¨€çš„æ˜¾ç¤ºåç§° / Get next language display name
  String get nextLanguageDisplay;
}
```

### æ·»åŠ æ–°çš„æœ¬åœ°åŒ–å­—ç¬¦ä¸² / Adding New Localized Strings

1. åœ¨ `lib/core/localization/app_strings.dart` ä¸­æ·»åŠ æ–°çš„é”®å€¼å¯¹ï¼š

```dart
// ä¸­æ–‡ç‰ˆæœ¬
'zh': {
  'new_key': 'æ–°çš„ä¸­æ–‡æ–‡æœ¬',
  // ... å…¶ä»–é”®
},

// è‹±æ–‡ç‰ˆæœ¬
'en': {
  'new_key': 'New English Text',
  // ... å…¶ä»–é”®
},
```

2. åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š

```dart
Text(context.l10n('new_key', fallback: 'é»˜è®¤æ–‡æœ¬'))
```

### æœ€ä½³å®è·µ / Best Practices

1. **ä¼˜å…ˆä½¿ç”¨ä¸€é”®åˆ‡æ¢** / Prefer One-Click Toggle
   ```dart
   // æ¨èï¼šä½¿ç”¨ä¸€é”®åˆ‡æ¢
   OneClickLanguageToggleButton()
   
   // æˆ–è€…åœ¨ä»£ç ä¸­
   await context.toggleLanguage();
   ```

2. **å§‹ç»ˆæä¾›fallbackæ–‡æœ¬** / Always Provide Fallback Text
   ```dart
   context.l10n('key', fallback: 'é»˜è®¤æ–‡æœ¬')
   ```

3. **ä¿æŒé”®åä¸€è‡´** / Keep Key Names Consistent
   - ç¡®ä¿æ‰€æœ‰è¯­è¨€ç‰ˆæœ¬éƒ½æœ‰ç›¸åŒçš„é”®
   - Ensure all language versions have the same keys

4. **ä½¿ç”¨æè¿°æ€§é”®å** / Use Descriptive Key Names
   ```dart
   // å¥½çš„ä¾‹å­ / Good example
   'task_creation_success' 
   
   // ä¸å¥½çš„ä¾‹å­ / Bad example
   'msg1'
   ```

5. **å¤„ç†åˆ‡æ¢é”™è¯¯** / Handle Toggle Errors
   ```dart
   try {
     await context.toggleLanguage();
   } catch (e) {
     // å¤„ç†é”™è¯¯ï¼Œå¦‚æ˜¾ç¤ºé”™è¯¯æç¤º
     ScaffoldMessenger.of(context).showSnackBar(
       SnackBar(content: Text('è¯­è¨€åˆ‡æ¢å¤±è´¥: $e')),
     );
   }
   ```

6. **ç›‘æ§æ€§èƒ½** / Monitor Performance
   ```dart
   // è·å–æ€§èƒ½ç»Ÿè®¡
   final performance = OneClickLanguageToggleButton.getPerformanceReport();
   if (performance.averageResponseTime > 200) {
     // æ€§èƒ½è­¦å‘Šå¤„ç†
   }
   ```

## æ”¯æŒçš„è¯­è¨€ / Supported Languages

- ğŸ‡¨ğŸ‡³ ä¸­æ–‡ (zh)
- ğŸ‡ºğŸ‡¸ English (en)

## æŠ€æœ¯å®ç° / Technical Implementation

### æ ¸å¿ƒç»„ä»¶ / Core Components

1. **OneClickLanguageToggleButton** - ä¸€é”®åˆ‡æ¢æŒ‰é’®ç»„ä»¶
2. **LanguageToggleState** - è¯­è¨€çŠ¶æ€æšä¸¾
3. **ToggleButtonState** - æŒ‰é’®çŠ¶æ€æ•°æ®æ¨¡å‹
4. **AppStrings** - å­—ç¬¦ä¸²å¸¸é‡å®šä¹‰
5. **AppLocalizations** - æœ¬åœ°åŒ–æœåŠ¡
6. **LanguageSwitcher** - ä¼ ç»ŸUIç»„ä»¶
7. **AppBloc** - çŠ¶æ€ç®¡ç†

### æ¶æ„ç‰¹ç‚¹ / Architecture Features

- **ä¸€é”®åˆ‡æ¢è®¾è®¡** / One-Click Toggle Design
  - æ— éœ€å¯¹è¯æ¡†ç¡®è®¤
  - No dialog confirmation needed
  - å³æ—¶å“åº”ç”¨æˆ·æ“ä½œ
  - Instant response to user actions
  - æ™ºèƒ½çŠ¶æ€æ˜¾ç¤º
  - Intelligent state display

- **éä¾µå…¥å¼è®¾è®¡** / Non-invasive Design
  - ç°æœ‰ç¡¬ç¼–ç æ–‡æœ¬ç»§ç»­å·¥ä½œ
  - Existing hardcoded text continues to work
  - æ”¯æŒæ¸è¿›å¼è¿ç§»
  - Supports gradual migration
  - å‘åå…¼å®¹
  - Backward compatible

- **å®Œå–„çš„é”™è¯¯å¤„ç†** / Comprehensive Error Handling
  - è‡ªåŠ¨é‡è¯•æœºåˆ¶
  - Automatic retry mechanism
  - çŠ¶æ€æ¢å¤åŠŸèƒ½
  - State recovery functionality
  - ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
  - User-friendly error messages

- **æ€§èƒ½ä¼˜åŒ–** / Performance Optimization
  - æŒ‰é’®çŠ¶æ€ç¼“å­˜
  - Button state caching
  - åŠ¨ç”»æ€§èƒ½ç›‘æ§
  - Animation performance monitoring
  - å†…å­˜ä½¿ç”¨ä¼˜åŒ–
  - Memory usage optimization

- **å®Œæ•´çš„å¯è®¿é—®æ€§** / Full Accessibility
  - å±å¹•é˜…è¯»å™¨æ”¯æŒ
  - Screen reader support
  - é”®ç›˜å¯¼èˆª
  - Keyboard navigation
  - é«˜å¯¹æ¯”åº¦æ¨¡å¼
  - High contrast mode

### æ­£ç¡®æ€§ä¿è¯ / Correctness Guarantees

ä¸€é”®åˆ‡æ¢åŠŸèƒ½å®ç°äº†ä»¥ä¸‹æ­£ç¡®æ€§å±æ€§ï¼š

1. **è¯­è¨€åˆ‡æ¢ä¸€è‡´æ€§** / Language Toggle Consistency
   - æ¯æ¬¡ç‚¹å‡»éƒ½ä¼šåˆ‡æ¢åˆ°å¦ä¸€ç§è¯­è¨€
   - Each click switches to the other language

2. **çŠ¶æ€æ˜¾ç¤ºåŒæ­¥æ€§** / State Display Synchronization
   - æŒ‰é’®æ˜¾ç¤ºä¸ç³»ç»Ÿè¯­è¨€çŠ¶æ€åŒæ­¥
   - Button display syncs with system language state

3. **æŒä¹…åŒ–ä¸€è‡´æ€§** / Persistence Consistency
   - è¯­è¨€è®¾ç½®æ­£ç¡®ä¿å­˜å’Œæ¢å¤
   - Language settings correctly saved and restored

4. **çŠ¶æ€ä¿æŒä¸å˜æ€§** / State Preservation Invariant
   - è¯­è¨€åˆ‡æ¢ä¸å½±å“å…¶ä»–åº”ç”¨çŠ¶æ€
   - Language switching doesn't affect other app states

5. **åˆ‡æ¢æ“ä½œå¹‚ç­‰æ€§** / Toggle Operation Idempotence
   - å¶æ•°æ¬¡åˆ‡æ¢å›åˆ°åˆå§‹è¯­è¨€
   - Even number of toggles return to initial language

6. **åŠ¨ç”»çŠ¶æ€ä¸€è‡´æ€§** / Animation State Consistency
   - åŠ¨ç”»å®ŒæˆåæŒ‰é’®å¤„äºç¨³å®šçŠ¶æ€
   - Button in stable state after animation completion

7. **é”™è¯¯æ¢å¤æ€§** / Error Recovery
   - åˆ‡æ¢å¤±è´¥æ—¶ä¿æŒåŸæœ‰çŠ¶æ€
   - Maintains original state when toggle fails

## æµ‹è¯• / Testing

### è¿è¡Œæµ‹è¯• / Running Tests

#### æœ¬åœ°åŒ–æµ‹è¯• / Localization Tests
```bash
flutter test test/core/localization/app_localizations_test.dart
```

#### ä¸€é”®åˆ‡æ¢åŠŸèƒ½æµ‹è¯• / One-Click Toggle Tests
```bash
# å•å…ƒæµ‹è¯•
flutter test test/core/widgets/one_click_language_toggle_button_test.dart

# å±æ€§æµ‹è¯•
flutter test test/core/widgets/language_toggle_consistency_property_test.dart
flutter test test/core/widgets/state_display_sync_property_test.dart
flutter test test/core/widgets/toggle_idempotence_property_test.dart

# é›†æˆæµ‹è¯•
flutter test test/core/widgets/one_click_language_toggle_integration_test.dart
```

#### æ€§èƒ½æµ‹è¯• / Performance Tests
```bash
flutter test test/core/widgets/language_toggle_performance_test.dart
```

### æµ‹è¯•è¦†ç›–èŒƒå›´ / Test Coverage

- âœ… è¯­è¨€åˆ‡æ¢ä¸€è‡´æ€§å±æ€§æµ‹è¯•
- âœ… çŠ¶æ€æ˜¾ç¤ºåŒæ­¥æ€§å±æ€§æµ‹è¯•  
- âœ… æŒä¹…åŒ–ä¸€è‡´æ€§å±æ€§æµ‹è¯•
- âœ… çŠ¶æ€ä¿æŒä¸å˜æ€§å±æ€§æµ‹è¯•
- âœ… åˆ‡æ¢æ“ä½œå¹‚ç­‰æ€§å±æ€§æµ‹è¯•
- âœ… åŠ¨ç”»çŠ¶æ€ä¸€è‡´æ€§å±æ€§æµ‹è¯•
- âœ… é”™è¯¯æ¢å¤æ€§å±æ€§æµ‹è¯•
- âœ… å¯è®¿é—®æ€§æµ‹è¯•
- âœ… æ€§èƒ½æµ‹è¯•
- âœ… é›†æˆæµ‹è¯•

## æœªæ¥æ‰©å±• / Future Extensions

1. **æ·»åŠ æ›´å¤šè¯­è¨€** / Add More Languages
   - æ—¥è¯­ (ja)
   - éŸ©è¯­ (ko)
   - æ³•è¯­ (fr)

2. **åŒºåŸŸåŒ–æ”¯æŒ** / Regionalization Support
   - ç®€ä½“ä¸­æ–‡ (zh-CN)
   - ç¹ä½“ä¸­æ–‡ (zh-TW)
   - ç¾å¼è‹±è¯­ (en-US)
   - è‹±å¼è‹±è¯­ (en-GB)

3. **åŠ¨æ€è¯­è¨€åŒ…** / Dynamic Language Packs
   - ä»æœåŠ¡å™¨åŠ è½½è¯­è¨€åŒ…
   - Load language packs from server

## æ•…éšœæ’é™¤ / Troubleshooting

### å¸¸è§é—®é¢˜ / Common Issues

1. **ä¸€é”®åˆ‡æ¢æŒ‰é’®æ— å“åº”** / One-Click Toggle Button Not Responding
   - æ£€æŸ¥AppBlocçŠ¶æ€æ˜¯å¦ä¸ºAppReadyState
   - Check if AppBloc state is AppReadyState
   - ç¡®ä¿æŒ‰é’®æ²¡æœ‰è¢«å…¶ä»–Widgeté®æŒ¡
   - Ensure button is not covered by other widgets
   - æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—
   - Check console for error logs

2. **è¯­è¨€åˆ‡æ¢åæ–‡æœ¬æ²¡æœ‰æ›´æ–°** / Text Not Updated After Language Switch
   - ç¡®ä¿ä½¿ç”¨äº† `context.l10n()` è€Œä¸æ˜¯ç¡¬ç¼–ç æ–‡æœ¬
   - Make sure you're using `context.l10n()` instead of hardcoded text
   - æ£€æŸ¥Widgetæ˜¯å¦æ­£ç¡®ç›‘å¬AppBlocçŠ¶æ€å˜åŒ–
   - Check if Widget properly listens to AppBloc state changes

3. **åˆ‡æ¢åŠ¨ç”»å¡é¡¿** / Toggle Animation Stuttering
   - æ£€æŸ¥è®¾å¤‡æ€§èƒ½æ˜¯å¦è¶³å¤Ÿ
   - Check if device performance is sufficient
   - ä½¿ç”¨æ€§èƒ½ç›‘æ§APIæ£€æŸ¥å¸§ç‡
   - Use performance monitoring API to check frame rate
   ```dart
   final performance = OneClickLanguageToggleButton.getPerformanceReport();
   print('å½“å‰FPS: ${performance.currentFps}');
   ```

4. **é”®ä¸å­˜åœ¨é”™è¯¯** / Key Not Found Error
   - æ£€æŸ¥ `app_strings.dart` ä¸­æ˜¯å¦å®šä¹‰äº†è¯¥é”®
   - Check if the key is defined in `app_strings.dart`
   - ç¡®ä¿æ‰€æœ‰è¯­è¨€ç‰ˆæœ¬éƒ½æœ‰è¯¥é”®
   - Ensure all language versions have the key

5. **åº”ç”¨å¯åŠ¨æ—¶è¯­è¨€ä¸æ­£ç¡®** / Incorrect Language on App Startup
   - æ£€æŸ¥ SharedPreferences æ˜¯å¦æ­£ç¡®ä¿å­˜
   - Check if SharedPreferences is saving correctly
   - ç¡®ä¿ AppBloc æ­£ç¡®åˆå§‹åŒ–
   - Ensure AppBloc is properly initialized

6. **åˆ‡æ¢å¹‚ç­‰æ€§éªŒè¯å¤±è´¥** / Toggle Idempotence Verification Failed
   - æ£€æŸ¥åˆ‡æ¢è®¡æ•°å™¨çŠ¶æ€
   - Check toggle counter state
   ```dart
   final stats = OneClickLanguageToggleButton.getToggleStatistics();
   print('åˆ‡æ¢æ¬¡æ•°: ${stats.toggleCount}');
   print('æ˜¯å¦ä¸ºå¥‡æ•°æ¬¡: ${stats.isOddToggle}');
   ```
   - å¿…è¦æ—¶é‡ç½®åˆ‡æ¢ä¼šè¯
   - Reset toggle session if necessary
   ```dart
   OneClickLanguageToggleButton.endToggleSession();
   ```

### è°ƒè¯•å·¥å…· / Debugging Tools

#### è·å–è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯ / Get Detailed Statistics
```dart
// åˆ‡æ¢ç»Ÿè®¡
final toggleStats = OneClickLanguageToggleButton.getToggleStatistics();

// æ€§èƒ½æŠ¥å‘Š
final performance = OneClickLanguageToggleButton.getPerformanceReport();

// ç¼“å­˜ç»Ÿè®¡
final cacheStats = OneClickLanguageToggleButton.getCacheStatistics();

// å†…å­˜ç»Ÿè®¡
final memoryStats = OneClickLanguageToggleButton.getMemoryStats();

// åŠ¨ç”»çŠ¶æ€æŠ¥å‘Š
final animationReport = OneClickLanguageToggleButton.getAnimationStateReport();
```

#### å¼ºåˆ¶æ¸…ç†å’Œé‡ç½® / Force Cleanup and Reset
```dart
// æ¸…ç†ç¼“å­˜å’Œå†…å­˜
OneClickLanguageToggleButton.performCleanup();

// é¢„çƒ­æ€§èƒ½ç»„ä»¶
OneClickLanguageToggleButton.warmupPerformanceComponents();

// æ£€æŸ¥åŠ¨ç”»ç¨³å®šæ€§
final isStable = OneClickLanguageToggleButton.areAnimationsStable();
```

---

## æ€»ç»“ / Summary

è¯­è¨€åˆ‡æ¢åŠŸèƒ½å·²æˆåŠŸé›†æˆåˆ°Prvin AIæ—¥å†åº”ç”¨ä¸­ï¼Œæä¾›äº†å®Œæ•´çš„ä¸­è‹±æ–‡åŒè¯­æ”¯æŒã€‚æ–°å¢çš„ä¸€é”®è¯­è¨€åˆ‡æ¢åŠŸèƒ½è®©ç”¨æˆ·ä½“éªŒæ›´åŠ æµç•…ï¼Œé‡‡ç”¨éä¾µå…¥å¼è®¾è®¡ï¼Œæ”¯æŒæ¸è¿›å¼è¿ç§»ï¼Œå…·æœ‰å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ€§èƒ½ä¼˜åŒ–æœºåˆ¶ï¼Œç¡®ä¿åº”ç”¨çš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚

The language switching feature has been successfully integrated into the Prvin AI Calendar app, providing complete bilingual support for Chinese and English. The new one-click language toggle feature makes the user experience smoother, uses a non-invasive design, supports gradual migration, and has comprehensive error handling and performance optimization mechanisms to ensure app stability and user experience.

### ä¸»è¦ä¼˜åŠ¿ / Key Advantages

- ğŸš€ **å³æ—¶åˆ‡æ¢** - ä¸€é”®æ“ä½œï¼Œæ— éœ€ç­‰å¾… / Instant switching - one-click operation, no waiting
- ğŸ¯ **ç›´è§‚æ˜“ç”¨** - æŒ‰é’®æ˜¾ç¤ºå½“å‰è¯­è¨€çŠ¶æ€ / Intuitive and easy - button shows current language state  
- ğŸ›¡ï¸ **ç¨³å®šå¯é ** - å®Œæ•´çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ä¿æŠ¤ / Stable and reliable - complete error handling and state protection
- âš¡ **æ€§èƒ½ä¼˜åŒ–** - æ™ºèƒ½ç¼“å­˜å’ŒåŠ¨ç”»ä¼˜åŒ– / Performance optimized - intelligent caching and animation optimization
- â™¿ **æ— éšœç¢å‹å¥½** - å®Œæ•´çš„å¯è®¿é—®æ€§æ”¯æŒ / Accessibility friendly - full accessibility support
- ğŸ”§ **æ˜“äºç»´æŠ¤** - æ¸…æ™°çš„APIå’Œå®Œå–„çš„æµ‹è¯•è¦†ç›– / Easy to maintain - clear API and comprehensive test coverage